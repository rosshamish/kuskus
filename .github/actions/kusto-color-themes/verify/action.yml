inputs:
  working-directory: 
    description: 'Working directory where package.json can be found'
    default: '.'
runs:
  using: "composite"
  steps: 
    - name: Extract contributed themes from package.json
      uses: sergeysova/jq-action@v2
      id: themes
      with:
        cmd: 'jq .contributes.themes[].path ${{ inputs.working-directory }}/package.json -r'
    - name: Verify each contributed theme exists
      shell: bash
      run: |
        errors=0
        echo "Checking if exists: ${{ steps.themes.outputs.value }}"
        for theme in ${{ steps.themes.outputs.value }}; do
          filepath="${{ inputs.working-directory }}/$theme"
          echo "Checking if exists: $filepath"
          if (test -f "$filepath"); then
            echo "Found: $filepath"
          else
            echo "Not found: $filepath"
            errors+=1
          fi
        done
        exit $errors
